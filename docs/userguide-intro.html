<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script src="https://cdn.statically.io/gh/scicloj/gorilla-notes@master/dist/0.5.10/main.js"></script>
    <script>
     shadow.loader.load("main");
     gorilla_notes.main.main_BANG_(false, "{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 1903, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Thu Mar 18 15:38:02 CET 2021\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"94\" \"95\" \"96\" \"97\" \"98\" \"99\" \"100\" \"101\" \"102\" \"103\" \"104\" \"105\" \"106\" \"107\" \"108\" \"61\" \"62\" \"109\" \"110\" \"111\" \"112\" \"113\" \"68\" \"69\" \"70\" \"71\" \"72\" \"73\" \"74\" \"75\" \"76\" \"77\" \"78\" \"79\" \"80\" \"114\" \"115\" \"116\" \"117\" \"118\" \"119\" \"120\" \"88\" \"121\"], :id->content {\"88\" [:div [:p] nil nil [:p/markdown \"Now we execute the pipeline, which will as well train the model. \"]], \"108\" [:div [:p] nil nil [:p/markdown \"This pipelines need to be repeatable and self-contained, as they need to run several times\\nwith different data or in variants\"]], \"69\" [:div [:p] nil nil [:p/markdown \"Metamorph is documented here: [metamorph](https://github.com/scicloj/metamorph)\"]], \"118\" [:div [:p] [:div [:p/code {:code \"(def reviews-split\\n  (first\\n   (ds/split->seq reviews :holdout)))\", :bg-class \"bg-light\"}]] nil nil], \"105\" [:div [:p] nil nil [:p/markdown \"So we have now a very reliable, mature, easy to use library to store and manipulate tabular data, including text.\"]], \"101\" [:div [:p] nil nil [:p/markdown \"In the last 2 years the Clojure data science landscape was shaped\\nby the appearance and maturation of a new library to manage tabular data.\"]], \"116\" [:div [:p] nil nil [:p/markdown \"First we load and split the data.\"]], \"61\" [:div [:p] nil nil [:p/markdown \"The `tablecoth` library contains already the concept of running a  pipeline on a dataset\"]], \"68\" [:div [:p] nil nil [:p/markdown \"It addresses both shortcomings of the simpler pipeline.\"]], \"96\" [:div [:p] nil nil [:p/markdown \"In order to practice machine learning and create an ecosystem of models around it,\\nwe need 2 pieces.\"]], \"80\" [:div [:p] nil nil [:p/markdown \"\\n\\n| namespace         | purpose                                                  |\\n|-------------------|----------------------------------------------------------|\\n| scicloj.ml.core   | core functionality for machine learning                  |\\n| scicloj.ml.ds     | functions to manipulate a dataset                        |\\n| scicloj.ml.mm     | metamorph compliant functions to be used in ml pipelines |\\n\\n \"]], \"113\" [:div [:p] nil nil [:p/markdown \"Due to this, the idea of the `metamorph` pipeline concept was born.\"]], \"98\" [:div [:p] nil nil [:p/markdown \"2. A standard way to express steps of data manipulations including train/predict of a model\"]], \"107\" [:div [:p] nil nil [:p/markdown \"In order to apply machine learning, the data needs to be transformed from its original form ,\\n(often as a data file), into the form required my the model.\\n Sometimes these transformation are simple, like chaning encodins, sometimes very complex.\\n In some contexts this is as well called feature engineering, which can result in arbitrary\\ncomplex data transformations.\\nThis transformations are dataset->dataset transformations.\\n\"]], \"115\" [:div [:p] [:div [:p/code {:code \"(require '[samskara.ml :as ml]\\n         '[samskara.metamorph :as mm]\\n         '[tech.v3.libs.smile.nlp :as nlp]\\n         )\", :bg-class \"bg-light\"}]] nil nil], \"73\" [:div [:p] nil nil [:p/markdown \"The Clojure ML ecosystem is based on different libraries working together, as\\nidiomatic in Clojure\"]], \"78\" [:div [:p] nil nil [:p/markdown \"\\n{:deps {\\n        scicloj.ml/scicloj.ml {:mvn/version \\\"0.1.0\\\"}} }\\n\"]], \"111\" [:div [:p] nil nil [:p/markdown \"This form of pipeline works to manipulate a dataset, but has 3 disadvantages.\"]], \"119\" [:div [:p] nil nil [:p/markdown \"Then we define the pipeline and it steps:\"]], \"100\" [:div [:p] nil nil [:p/markdown \"## Representing training data\"]], \"106\" [:div [:p] nil nil [:p/markdown \"## Data transformation pipelines.\"]], \"112\" [:div [:p] nil nil [:p/markdown \"\\n1. `->` is a macro, so we cannot compose pipelines easily\\n2. We move a dataset object through the pipeline steps, the so only object we have nicely inside the pipeline is the dataset itself.\\n But sometimes we need non-tabular, auxiliary data to be shared across the pipeline steps,\\nwhich is not possible with passing a dataset only.\\n\\nUsing this simple pipelines, would force\\nto hold auxiliary data in a global state of some form.\\nThis makes is very hard to execute pipelines repeatedly, as they are not self-contained.\\n\"]], \"121\" [:div [:p] [:div [:p/code {:code \"(def trained-ctx\\n  (pipe-fn {:metamorph/data (:train reviews-split)\\n            :metamorph/mode :fit}))\", :bg-class \"bg-light\"}]] nil nil], \"62\" [:div [:p] nil nil [:p/markdown \"The simplest form of a pipeline in Clojure and Tablecloth, can just make use of the fact that all tablecloth functions take a dataset as\\n the first parameter and return a dataset. So they can be chained together with the pipe (`->`) operator of Clojure, example:\"]], \"75\" [:div [:p] nil nil [:p/markdown \"\\n1. `Tabelcloth` to manipulate the dataset\\n2. `Metamorph.ml` Running pipelines and machine learning core functions\\n3. `tech.ml.smile` containing ML models and NLP functions based on Smile\\n\"]], \"76\" [:div [:p] nil nil [:p/markdown \"[Smile](https://haifengl.github.io/) is a complete data science package for Java.\\nVarious smile models are made available to Clojure by `tech.ml.smile` \"]], \"110\" [:div [:p] [:div [:p/code {:code \"(def my-data\\n  (-> (ds/dataset \\\"https://raw.githubusercontent.com/techascent/tech.ml.dataset/master/test/data/stocks.csv\\\" {:key-fn keyword})\\n      (ds/select-columns [:symbol :price])\\n      (ds/add-or-replace-column :symbol (fn [ds] (map clojure.string/lower-case  (ds :symbol)) ))\\n      ))\", :bg-class \"bg-light\"}]] nil nil], \"97\" [:div [:p] nil nil [:p/markdown \"1. A standard way to store data.\"]], \"94\" [:div [:p] [:div [:p/code {:code \"(comment\\n  (note/init-with-browser)\\n  (note/eval-this-notespace)\\n  (note/reread-this-notespace)\\n  (note/render-static-html)\\n  (note/init)\\n  (note/update-config)\\n\\n(notespace.api/update-config\\n  #(assoc % :source-base-path \\\"userguide\\\"))\\n\\n  )\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"99\" [:div [:p] nil nil [:p/markdown \"The Clojure language and core libraries do not have build-in, specific support for this,\\nso some libraries are required. \"]], \"120\" [:div [:p] [:div [:p/code {:code \"(def pipe-fn\\n  (ml/pipeline\\n   (mm/select-columns [:Text :Score])\\n   (mm/count-vectorize :Text :bow nlp/default-text->bow {})\\n   (mm/bow->sparse-array :bow :bow-sparse #(nlp/->vocabulary-top-n % 1000))\\n   (mm/set-inference-target :Score)\\n   (mm/select-columns [:bow-sparse :Score])\\n   (mm/model {:p 1000\\n              :model-type :smile.classification/maxent-multinomial\\n              :sparse-column :bow-sparse})\\n   ))\", :bg-class \"bg-light\"}]] nil nil], \"70\" [:div [:p] nil nil [:p/markdown \"It adds as well a third missing feature to the simple pipeline concept, mainly to run a pipeline\\nin 2 modes :fit and :transform, which is required for machine learning\"]], \"77\" [:div [:p] nil nil [:p/markdown \"The setup for the following code needs a single dependencies in deps.edn or project.clj\"]], \"104\" [:div [:p] nil nil [:p/markdown \"This was addressed by an other library, layering on top of it, called `tablecloth`\\nIt is available [here](https://github.com/scicloj/tablecloth)\"]], \"95\" [:div [:p] nil nil [:p/markdown \"# Clojure and machine learning \"]], \"102\" [:div [:p] nil nil [:p/markdown \"This library is [tech.ml.dataset](https://github.com/techascent/tech.ml.dataset).\\n It defines a in-memory tabular data structure and operations on it. It is a remarkable piece of software,\\nhighly optimized and linking in its root to native memory and allow zero-copy integration's outside Clojure.\"]], \"74\" [:div [:p] nil nil [:p/markdown \"Three different libraries are used internally, to create a working ml / nlp pipleine,\\nbut this is hidden from the user, but is listed here for completeness.\"]], \"109\" [:div [:p] [:div [:p/code {:code \"(require '[samskara.dataset :as ds])\", :bg-class \"bg-light\"}]] nil nil], \"114\" [:div [:p] nil nil [:p/markdown \"The we need to require s few namespaces from the three libraries\"]], \"72\" [:div [:p] nil nil [:p/markdown \"Tablecloth contains such operations in the `tablecloth.pipeline` name space. All functions of the `tablecloth.api` ns are replicated there,\\n but metamorph compliant\"]], \"103\" [:div [:p] nil nil [:p/markdown \"As it was organically growing over time, it's API is functional and complete,\\nbut lacks consistency in some parts.\\n\"]], \"71\" [:div [:p] nil nil [:p/markdown \"So a pipeline can be composed of functions, which adhere to the simple standards regarding input and output, as explained here:\\nhttps://github.com/scicloj/metamorph#compliant-operations\"]], \"79\" [:div [:p] nil nil [:p/markdown \"This library acts as a facade to the three libraries above, and arranges the functions in a simple way in these namespaces:\"]], \"117\" [:div [:p] [:div [:p/code {:code \"(def reviews\\n  (ds/dataset \\\"https://github.com/scicloj/metamorph-examples/raw/main/data/reviews.csv.gz\\\"\\n              {:key-fn keyword}))\", :bg-class \"bg-light\"}]] nil nil]}}");
     document.getElementById("loading").remove();
    </script>
</html>
