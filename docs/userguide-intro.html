<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script src="https://cdn.statically.io/gh/scicloj/gorilla-notes@master/dist/0.5.10/main.js"></script>
    <script>
     shadow.loader.load("main");
     gorilla_notes.main.main_BANG_(false, "{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 1903, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Fri Mar 19 09:42:23 CET 2021\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"56\" \"57\" \"58\" \"59\" \"60\" \"61\" \"62\" \"63\" \"64\" \"65\" \"66\" \"67\" \"68\" \"69\" \"70\" \"71\" \"72\" \"73\" \"74\" \"75\" \"76\" \"77\" \"78\" \"79\" \"80\" \"81\" \"82\" \"83\" \"84\" \"85\" \"86\" \"87\" \"88\" \"89\" \"90\" \"91\" \"92\" \"93\" \"94\" \"95\" \"96\" \"97\" \"98\" \"99\" \"100\" \"101\" \"102\" \"103\" \"104\" \"105\" \"106\" \"107\" \"108\" \"109\"], :id->content {\"58\" [:div [:p] nil nil [:p/markdown \"In order to practice machine learning and create an ecosystem of models around it,\\nwe need 2 pieces.\"]], \"88\" [:div [:p] nil nil [:p/markdown \"The setup for the following code needs a single dependencies in deps.edn or project.clj\"]], \"108\" [:div [:p] [:div [:p/code {:code \"(def pipe-fn\\n  (ml/pipeline\\n   (mm/select-columns [:Text :Score ])\\n   (mm/count-vectorize :Text :bow)\\n   (mm/bow->sparse-array :bow :bow-sparse)\\n   (mm/set-inference-target :Score)\\n   (mm/select-columns [:bow-sparse :Score])\\n   (fn [ctx]\\n     (let [p (-> ctx :tech.v3.libs.smile.metamorph/count-vectorize-vocabulary\\n                 :vocab\\n                 count\\n                 )]\\n       ((mm/model {:p p\\n                   :model-type :smile.classification/maxent-multinomial\\n                   :sparse-column :bow-sparse})\\n        ctx)))\\n   ))\", :bg-class \"bg-light\"}]] nil nil], \"93\" [:div [:p] [:div [:p/code {:code \"(require '[samskara.ml :as ml]\\n         '[samskara.metamorph :as mm]\\n         '[samskara.dataset :as ds]\\n         '[tech.v3.libs.smile.nlp :as nlp]\\n         )\", :bg-class \"bg-light\"}]] nil nil], \"83\" [:div [:p] nil nil [:p/markdown \"The Clojure ML ecosystem is based on different libraries working together, as\\nidiomatic in Clojure\"]], \"69\" [:div [:p] nil nil [:p/markdown \"In order to apply machine learning, the data needs to be transformed from its original form ,\\n(often as a data file), into the form required my the model.\\n Sometimes these transformation are simple, like chaning encodins, sometimes very complex.\\n In some contexts this is as well called feature engineering, which can result in arbitrary\\ncomplex data transformations.\\nThis transformations are dataset->dataset transformations.\\n\"]], \"87\" [:div [:p] nil nil [:p/markdown \"In order to give easier accesss to the variuos libraries, the samskara project library was created.\\nIt unifies teh access to the libaries above in three namespaces.\\n\"]], \"105\" [:div [:p] nil nil [:p/markdown \"More advanced use case, as we need to pass the vocab size betweenn steps\"]], \"60\" [:div [:p] nil nil [:p/markdown \"2. A standard way to express steps of data manipulations including train/predict of a model\"]], \"82\" [:div [:p] nil nil [:p/markdown \"Tablecloth contains such operations in the `tablecloth.pipeline` name space. All functions of the `tablecloth.api` ns are replicated there,\\n but metamorph compliant\"]], \"101\" [:div [:p] nil nil [:p/markdown \"Now we execute the pipeline in :transform,\\nwhich wil make a prediction \"]], \"59\" [:div [:p] nil nil [:p/markdown \"1. A standard way to store data.\"]], \"89\" [:div [:p] nil nil [:p/markdown \"\\n{:deps {\\n        samskara/samskara {:mvn/version \\\"0.1.0\\\"}} }\\n\"]], \"61\" [:div [:p] nil nil [:p/markdown \"The Clojure language and core libraries do not have build-in, specific support for this,\\nso some libraries are required. \"]], \"57\" [:div [:p] nil nil [:p/markdown \"# Clojure and machine learning \"]], \"68\" [:div [:p] nil nil [:p/markdown \"## Data transformation pipelines.\"]], \"96\" [:div [:p] [:div [:p/code {:code \"(def titanic-test\\n  (->\\n   (ds/dataset \\\"https://github.com/scicloj/metamorph-examples/raw/main/data/titanic/test.csv\\\"\\n               {:key-fn keyword\\n                :parser-fn :string\\n                })\\n   (ds/add-column :Survived [\\\"0\\\"])\\n   ))\", :bg-class \"bg-light\"}]] nil nil], \"80\" [:div [:p] nil nil [:p/markdown \"It adds as well a third missing feature to the simple pipeline concept, mainly to run a pipeline\\nin 2 modes :fit and :transform, which is required for machine learning\"]], \"67\" [:div [:p] nil nil [:p/markdown \"So we have now a very reliable, mature, easy to use library to store and manipulate tabular data, including text.\"]], \"81\" [:div [:p] nil nil [:p/markdown \"So a pipeline can be composed of functions, which adhere to the simple standards regarding input and output, as explained here:\\nhttps://github.com/scicloj/metamorph#compliant-operations\"]], \"98\" [:div [:p] [:div [:p/code {:code \"(def pipe-fn\\n  (ml/pipeline\\n   (mm/select-columns [:Survived :Sex ])\\n   (mm/categorical->number [:Survived :Sex])\\n   (mm/set-inference-target :Survived)\\n   (mm/model {:model-type :smile.classification/logistic-regression})))\", :bg-class \"bg-light\"}]] nil nil], \"107\" [:div [:p] [:div [:p/code {:code \"(def reviews-split\\n  (first\\n   (ds/split->seq reviews :holdout)))\", :bg-class \"bg-light\"}]] nil nil], \"73\" [:div [:p] [:div [:p/code {:code \"(require '[samskara.dataset :as ds])\", :bg-class \"bg-light\"}]] nil nil], \"78\" [:div [:p] nil nil [:p/markdown \"It addresses both shortcomings of the simpler pipeline.\"]], \"66\" [:div [:p] nil nil [:p/markdown \"This was addressed by an other library, layering on top of it, called `tablecloth`\\nIt is available [here](https://github.com/scicloj/tablecloth)\"]], \"100\" [:div [:p] [:div [:p/code {:code \"(def trained-ctx\\n  (pipe-fn {:metamorph/data titanic-train\\n            :metamorph/mode :fit}))\", :bg-class \"bg-light\"}]] nil nil], \"106\" [:div [:p] [:div [:p/code {:code \"(def reviews\\n  (ds/dataset \\\"https://github.com/scicloj/metamorph-examples/raw/main/data/reviews.csv.gz\\\"\\n              {:key-fn keyword}))\", :bg-class \"bg-light\"}]] nil nil], \"90\" [:div [:p] nil nil [:p/markdown \"This library acts as a facade to the three libraries above, and arranges the functions in a simple way in these namespaces:\"]], \"62\" [:div [:p] nil nil [:p/markdown \"## Representing training data\"]], \"75\" [:div [:p] nil nil [:p/markdown \"This form of pipeline works to manipulate a dataset, but has 3 disadvantages.\"]], \"76\" [:div [:p] nil nil [:p/markdown \"\\n1. `->` is a macro, so we cannot compose pipelines easily\\n2. We move a dataset object through the pipeline steps, the so only object we have nicely inside the pipeline is the dataset itself.\\n But sometimes we need non-tabular, auxiliary data to be shared across the pipeline steps,\\nwhich is not possible with passing a dataset only.\\n\\nUsing this simple pipelines, would force\\nto hold auxiliary data in a global state of some form.\\nThis makes is very hard to execute pipelines repeatedly, as they are not self-contained.\\n\"]], \"97\" [:div [:p] nil nil [:p/markdown \"Then we define the pipeline and it steps:\"]], \"94\" [:div [:p] nil nil [:p/markdown \"First we load the data.\"]], \"99\" [:div [:p] nil nil [:p/markdown \"Now we execute the pipeline in mode :fit,\\nwhich will as well train the model. \"]], \"70\" [:div [:p] nil nil [:p/markdown \"This pipelines need to be repeatable and self-contained, as they need to run several times\\nwith different data or in variants\"]], \"77\" [:div [:p] nil nil [:p/markdown \"Due to this, the idea of the `metamorph` pipeline concept was born.\"]], \"63\" [:div [:p] nil nil [:p/markdown \"In the last 2 years the Clojure data science landscape was shaped\\nby the appearance and maturation of a new library to manage tabular data.\"]], \"84\" [:div [:p] nil nil [:p/markdown \"Three different libraries are used internally, to create a working ml / nlp pipleine,\\nbut this is hidden from the user, but is listed here for completeness.\"]], \"104\" [:div [:p] [:div [:p/code {:code \"^kind/dataset\\n(:metamorph/data test-ctx)\", :bg-class \"bg-light\"}]] nil [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"400px\"}} [:p/markdown \":_unnamed [418 3]:\\n\\n|       1 |       0 | :Survived |\\n|---------|---------|-----------|\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n|  0.1893 |  0.8107 |       1.0 |\\n|  0.7412 |  0.2588 |       0.0 |\\n\"]]], \"95\" [:div [:p] [:div [:p/code {:code \"(def titanic-train\\n  (ds/dataset \\\"https://github.com/scicloj/metamorph-examples/raw/main/data/titanic/train.csv\\\"\\n               {:key-fn keyword\\n               :parser-fn :string\\n                }))\", :bg-class \"bg-light\"}]] nil nil], \"102\" [:div [:p] [:div [:p/code {:code \"(def test-ctx\\n  (pipe-fn\\n   (assoc trained-ctx\\n          :metamorph/data titanic-test\\n          :metamorph/mode :transform)))\", :bg-class \"bg-light\"}]] nil nil], \"74\" [:div [:p] [:div [:p/code {:code \"(def my-data\\n  (-> (ds/dataset \\\"https://raw.githubusercontent.com/techascent/tech.ml.dataset/master/test/data/stocks.csv\\\" {:key-fn keyword})\\n      (ds/select-columns [:symbol :price])\\n      (ds/add-or-replace-column :symbol (fn [ds] (map clojure.string/lower-case  (ds :symbol)) ))\\n      ))\", :bg-class \"bg-light\"}]] nil nil], \"109\" [:div [:p] [:div [:p/code {:code \"(def trained-ctx\\n  (pipe-fn {:metamorph/data (:train reviews-split)\\n            :metamorph/mode :fit}))\", :bg-class \"bg-light\"}]] nil nil], \"56\" [:div [:p] [:div [:p/code {:code \"(comment\\n  (note/init-with-browser)\\n  (note/eval-this-notespace)\\n  (note/reread-this-notespace)\\n  (note/render-static-html \\\"docs/userguide-intro.html\\\")\\n  (note/init)\\n  (note/update-config)\\n\\n(notespace.api/update-config\\n  #(assoc % :source-base-path \\\"userguide\\\"))\\n\\n  )\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"85\" [:div [:p] nil nil [:p/markdown \"\\n1. `Tabelcloth` to manipulate the dataset\\n2. `Metamorph.ml` Running pipelines and machine learning core functions\\n3. `tech.ml.smile` containing ML models and NLP functions based on Smile\\n\"]], \"72\" [:div [:p] nil nil [:p/markdown \"The simplest form of a pipeline in Clojure and Tablecloth, can just make use of the fact that all tablecloth functions take a dataset as\\n the first parameter and return a dataset. So they can be chained together with the pipe (`->`) operator of Clojure, example:\"]], \"103\" [:div [:p] nil nil [:p/markdown \"Prediction:\"]], \"91\" [:div [:p] nil nil [:p/markdown \"\\n\\n| namespace           | purpose                                                  |\\n|---------------------|----------------------------------------------------------|\\n| samskara.ml         | core functionality for machine learning                  |\\n| samskara.dataset    | functions to manipulate a dataset                        |\\n| samskara.methamorph | metamorph compliant functions to be used in ml pipelines |\\n\\n \"]], \"65\" [:div [:p] nil nil [:p/markdown \"As it was organically growing over time, it's API is functional and complete,\\nbut lacks consistency in some parts.\\n\"]], \"71\" [:div [:p] nil nil [:p/markdown \"The `tablecoth` library contains already the concept of running a  pipeline on a dataset\"]], \"86\" [:div [:p] nil nil [:p/markdown \"[Smile](https://haifengl.github.io/) is a complete data science package for Java.\\nVarious smile models are made available to Clojure by `tech.ml.smile` \"]], \"64\" [:div [:p] nil nil [:p/markdown \"This library is [tech.ml.dataset](https://github.com/techascent/tech.ml.dataset).\\n It defines a in-memory tabular data structure and operations on it. It is a remarkable piece of software,\\nhighly optimized and linking in its root to native memory and allow zero-copy integration's outside Clojure.\"]], \"92\" [:div [:p] nil nil [:p/markdown \"To start we need to require a few namespaces\"]], \"79\" [:div [:p] nil nil [:p/markdown \"Metamorph is documented here: [metamorph](https://github.com/scicloj/metamorph)\"]]}}");
     document.getElementById("loading").remove();
    </script>
</html>
